<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>quickff.system &mdash; QuickFF 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="QuickFF 1.0 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">QuickFF 1.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for quickff.system</h1><div class="highlight"><pre>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c"># QuickFF is a code to quickly derive accurate force fields from ab initio input.</span>
<span class="c"># Copyright (C) 2012 - 2015 Louis Vanduyfhuys &lt;Louis.Vanduyfhuys@UGent.be&gt;</span>
<span class="c"># Steven Vandenbrande &lt;Steven.Vandenbrande@UGent.be&gt;,</span>
<span class="c"># Toon Verstraelen &lt;Toon.Verstraelen@UGent.be&gt;, Center for Molecular Modeling</span>
<span class="c"># (CMM), Ghent University, Ghent, Belgium; all rights reserved unless otherwise</span>
<span class="c"># stated.</span>
<span class="c">#</span>
<span class="c"># This file is part of QuickFF.</span>
<span class="c">#</span>
<span class="c"># QuickFF is free software; you can redistribute it and/or</span>
<span class="c"># modify it under the terms of the GNU General Public License</span>
<span class="c"># as published by the Free Software Foundation; either version 3</span>
<span class="c"># of the License, or (at your option) any later version.</span>
<span class="c">#</span>
<span class="c"># QuickFF is distributed in the hope that it will be useful,</span>
<span class="c"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c"># GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c"># You should have received a copy of the GNU General Public License</span>
<span class="c"># along with this program; if not, see &lt;http://www.gnu.org/licenses/&gt;</span>
<span class="c">#</span>
<span class="c">#--</span>

<span class="kn">from</span> <span class="nn">molmod.periodic</span> <span class="kn">import</span> <span class="n">periodic</span> <span class="k">as</span> <span class="n">pt</span>
<span class="kn">from</span> <span class="nn">molmod.molecules</span> <span class="kn">import</span> <span class="n">Molecule</span>
<span class="kn">from</span> <span class="nn">molmod.molecular_graphs</span> <span class="kn">import</span> <span class="n">MolecularGraph</span>
<span class="kn">from</span> <span class="nn">molmod.io.chk</span> <span class="kn">import</span> <span class="n">load_chk</span><span class="p">,</span> <span class="n">dump_chk</span>
<span class="kn">from</span> <span class="nn">molmod.io.fchk</span> <span class="kn">import</span> <span class="n">FCHKFile</span>
<span class="kn">from</span> <span class="nn">molmod.io.psf</span> <span class="kn">import</span> <span class="n">PSFFile</span>
<span class="kn">from</span> <span class="nn">molmod.units</span> <span class="kn">import</span> <span class="n">deg</span><span class="p">,</span> <span class="n">angstrom</span><span class="p">,</span> <span class="n">kjmol</span>
<span class="kn">from</span> <span class="nn">molmod.ic</span> <span class="kn">import</span> <span class="n">bond_length</span><span class="p">,</span> <span class="n">bend_angle</span><span class="p">,</span> <span class="n">dihed_angle</span><span class="p">,</span> <span class="n">opbend_dist</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">quickff.refdata</span> <span class="kn">import</span> <span class="n">ReferenceData</span>
<span class="kn">from</span> <span class="nn">quickff.ic</span> <span class="kn">import</span> <span class="n">IC</span>
<span class="kn">from</span> <span class="nn">quickff.tools</span> <span class="kn">import</span> <span class="n">find_opdist_patterns</span>
<span class="kn">from</span> <span class="nn">quickff.uff</span> <span class="kn">import</span> <span class="n">get_uff_sigmas_epsilons</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;System&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="System"><a class="viewcode-back" href="../../rg_system.html#quickff.system.System">[docs]</a><span class="k">class</span> <span class="nc">System</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        A class for storing all system properties such as atom numbers, force</span>
<span class="sd">        field atom types, charges, vdW parameters, bonds, bends, dihedrals,</span>
<span class="sd">        out-of-plane patterns, neighborlists and the ab initio reference data.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numbers</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">ffatypes</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">charges</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="n">epsilons</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sigmas</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">bonds</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">bends</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="n">diheds</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">opdists</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">nlist</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">           **Arguments:**</span>

<span class="sd">           numbers</span>
<span class="sd">                A numpy array (N) with atomic numbers.</span>

<span class="sd">           ref</span>
<span class="sd">                An instance of ReferenceData containing the reference data</span>
<span class="sd">                from which the force field will be estimated.</span>

<span class="sd">           **Optional Arguments**</span>

<span class="sd">           ffatypes</span>
<span class="sd">                A numpy array (N) with force field atom types.</span>

<span class="sd">           charges</span>
<span class="sd">                A numpy array (N) with atomic charges. By default, all charges</span>
<span class="sd">                are zero.</span>

<span class="sd">           radii</span>
<span class="sd">                A numpy array (N) with atomic radii determining the width of the</span>
<span class="sd">                charge distribution. By default, all radii are zero.</span>

<span class="sd">           epsilons</span>
<span class="sd">                A numpy array (N) with vdw epsilons values. By default, all</span>
<span class="sd">                epsilons are zero.</span>

<span class="sd">           sigmas</span>
<span class="sd">                A numpy array (N) with vdw sigma values. By default, all sigmas</span>
<span class="sd">                are zero.</span>

<span class="sd">           bonds</span>
<span class="sd">                A numpy array (B,2) with atom indexes (counting starts from</span>
<span class="sd">                zero) to define topological bond patterns. If no bonds are</span>
<span class="sd">                given, they are estimated from the geometry in ref.coords.</span>

<span class="sd">           bends</span>
<span class="sd">                A numpy array (A,3) with atom indexes (counting starts from</span>
<span class="sd">                zero) to define topological bend patterns. If no bends are</span>
<span class="sd">                given, they are derived from the bonds.</span>

<span class="sd">           diheds</span>
<span class="sd">                A numpy array (D,4) with atom indexes (counting starts from</span>
<span class="sd">                zero) to define topological dihedrall patterns. If no dihedrals</span>
<span class="sd">                are given, they are derived from the bonds.</span>

<span class="sd">           opdists</span>
<span class="sd">                A numpy array (O,4) with atom indexes (counting starts from</span>
<span class="sd">                zero) to define topological out of plane patterns. The first</span>
<span class="sd">                three atoms define the plane, while the last atom defines</span>
<span class="sd">                the center atom. If no opdists are given, they are derived</span>
<span class="sd">                from the bonds.</span>

<span class="sd">           nlist</span>
<span class="sd">                A dictionnairy containing the neighbors for every atom. If nlist</span>
<span class="sd">                is not given, it is derived from the bonds.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numbers</span> <span class="o">=</span> <span class="n">numbers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ffatypes</span> <span class="o">=</span> <span class="n">ffatypes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charges</span> <span class="o">=</span> <span class="n">charges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radii</span> <span class="o">=</span> <span class="n">radii</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilons</span> <span class="o">=</span> <span class="n">epsilons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigmas</span> <span class="o">=</span> <span class="n">sigmas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bonds</span> <span class="o">=</span> <span class="n">bonds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bends</span> <span class="o">=</span> <span class="n">bends</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diheds</span> <span class="o">=</span> <span class="n">diheds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opdists</span> <span class="o">=</span> <span class="n">opdists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlist</span> <span class="o">=</span> <span class="n">nlist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="n">ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c">#Set attributes to zero if they are not defined</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">charges</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">charges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">natoms</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">radii</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">natoms</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilons</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">epsilons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">natoms</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmas</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sigmas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">natoms</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="c">#perfrom some checks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ref</span><span class="o">.</span><span class="n">_check</span><span class="p">(</span><span class="n">natoms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">natoms</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_topology</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ffatypes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_average_charges_ffatypes</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_natoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&#39;Get the number of atoms in the system&#39;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numbers</span><span class="p">)</span>

    <span class="n">natoms</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_natoms</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="System.from_files"><a class="viewcode-back" href="../../rg_system.html#quickff.system.System.from_files">[docs]</a>    <span class="k">def</span> <span class="nf">from_files</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">fns</span><span class="p">,</span> <span class="n">ei_path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">vdw_path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">           A method to construct a System instance from input files. If</span>
<span class="sd">           the input files do not contain the topology, it is estimated</span>
<span class="sd">           from the geometry.</span>

<span class="sd">           **Arguments:**</span>

<span class="sd">           fns</span>
<span class="sd">                A list of file names. Files further on in the list will</span>
<span class="sd">                overwrite earlier files if there is overlap. txt files</span>
<span class="sd">                can only be used in hipart format to define charges. HDF5</span>
<span class="sd">                files can only be used in Horton format to define charges.</span>
<span class="sd">                The set of charges that will be extracted from the HDF5</span>
<span class="sd">                file is dependant on the charge scheme defined in the</span>
<span class="sd">                kwargs.</span>

<span class="sd">           **Optional Arguments:**</span>

<span class="sd">           ei_path</span>
<span class="sd">                A string defining the path in the HDF5 file which contains a</span>
<span class="sd">                dataset `EI_PATH/charges` (and `EI_PATH/radii` in case of</span>
<span class="sd">                Gaussian charges) from which the atomic charges will be</span>
<span class="sd">                extracted.</span>

<span class="sd">           vdw_path</span>
<span class="sd">                A string defining the path in the HDF5 file which contains 2</span>
<span class="sd">                datasets, `VDW_PATH/epsilons` and `VDW_PATH/sigmas` from which</span>
<span class="sd">                the atomic vdW parameters will be extracted.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c">#initialise</span>
        <span class="n">numbers</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">charges</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">radii</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">epsilons</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">sigmas</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">ffatypes</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">bonds</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">bends</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">diheds</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">opdists</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">nlist</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">ref</span> <span class="o">=</span> <span class="n">ReferenceData</span><span class="p">()</span>
        <span class="c">#Read all input files</span>
        <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">fns</span><span class="p">:</span>
            <span class="n">extension</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">extension</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;chk&#39;</span><span class="p">,</span> <span class="s">&#39;mfs&#39;</span><span class="p">]:</span>
                <span class="n">sample</span> <span class="o">=</span> <span class="n">load_chk</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">sample</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;numbers&#39;</span><span class="p">]:</span>
                        <span class="n">numbers</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;charges&#39;</span><span class="p">,</span> <span class="s">&#39;ac&#39;</span><span class="p">,</span> <span class="s">&#39;aq&#39;</span><span class="p">]:</span>
                        <span class="n">charges</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;radii&#39;</span><span class="p">]:</span>
                        <span class="n">radii</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;epsilons&#39;</span><span class="p">]:</span>
                        <span class="n">epsilons</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;sigmas&#39;</span><span class="p">]:</span>
                        <span class="n">sigmas</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;ffatypes&#39;</span><span class="p">,</span> <span class="s">&#39;atypes&#39;</span><span class="p">]:</span>
                        <span class="n">ffatypes</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;bonds&#39;</span><span class="p">]:</span>
                        <span class="n">bonds</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;bends&#39;</span><span class="p">,</span> <span class="s">&#39;angles&#39;</span><span class="p">]:</span>
                        <span class="n">bends</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;diheds&#39;</span><span class="p">,</span> <span class="s">&#39;dihedrals&#39;</span><span class="p">]:</span>
                        <span class="n">diheds</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;opdists&#39;</span><span class="p">]:</span>
                        <span class="n">opdists</span> <span class="o">=</span> <span class="n">value</span>
                    <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;coords&#39;</span><span class="p">,</span> <span class="s">&#39;coordinates&#39;</span><span class="p">,</span> <span class="s">&#39;pos&#39;</span><span class="p">]:</span>
                        <span class="n">ref</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">coords</span><span class="o">=</span><span class="n">value</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
                    <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;gradient&#39;</span><span class="p">,</span> <span class="s">&#39;grad&#39;</span><span class="p">,</span> <span class="s">&#39;gpos&#39;</span><span class="p">,</span> <span class="s">&#39;forces&#39;</span><span class="p">]:</span>
                        <span class="n">ref</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">grad</span><span class="o">=</span><span class="n">value</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
                    <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;hessian&#39;</span><span class="p">,</span> <span class="s">&#39;hess&#39;</span><span class="p">]:</span>
                        <span class="n">natoms</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">size</span><span class="o">/</span><span class="mi">9</span><span class="p">))</span>
                        <span class="n">ref</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">hess</span><span class="o">=</span><span class="n">value</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">natoms</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">natoms</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">extension</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;fchk&#39;</span><span class="p">]:</span>
                <span class="n">fchk</span> <span class="o">=</span> <span class="n">FCHKFile</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
                <span class="n">numbers</span> <span class="o">=</span> <span class="n">fchk</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;Atomic numbers&#39;</span><span class="p">)</span>
                <span class="n">ref</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">coords</span><span class="o">=</span><span class="n">fchk</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;Current cartesian coordinates&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">numbers</span><span class="p">),</span> <span class="mi">3</span><span class="p">]))</span>
                <span class="n">ref</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">grad</span><span class="o">=</span><span class="n">fchk</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;Cartesian Gradient&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">numbers</span><span class="p">),</span> <span class="mi">3</span><span class="p">]))</span>
                <span class="n">ref</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">hess</span><span class="o">=</span><span class="n">fchk</span><span class="o">.</span><span class="n">get_hessian</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">numbers</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">numbers</span><span class="p">),</span> <span class="mi">3</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">extension</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;psf&#39;</span><span class="p">]:</span>
                <span class="n">psf</span> <span class="o">=</span> <span class="n">PSFFile</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
                <span class="n">numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">psf</span><span class="o">.</span><span class="n">numbers</span><span class="p">)</span>
                <span class="n">ffatypes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">psf</span><span class="o">.</span><span class="n">atom_types</span><span class="p">)</span>
                <span class="n">charges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">psf</span><span class="o">.</span><span class="n">charges</span><span class="p">)</span>
                <span class="n">bonds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">psf</span><span class="o">.</span><span class="n">bonds</span><span class="p">)</span>
                <span class="n">bends</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">psf</span><span class="o">.</span><span class="n">bends</span><span class="p">)</span>
                <span class="n">diheds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">psf</span><span class="o">.</span><span class="n">dihedrals</span><span class="p">)</span>
                <span class="n">nlist</span> <span class="o">=</span> <span class="n">psf</span><span class="o">.</span><span class="n">get_molecular_graph</span><span class="p">()</span><span class="o">.</span><span class="n">neighbors</span>
            <span class="k">elif</span> <span class="n">extension</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;h5&#39;</span><span class="p">]:</span>
                <span class="kn">import</span> <span class="nn">h5py</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ei_path</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">vdw_path</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">print</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">WARNING: a HDF5 file was given but both ei_path and&#39;</span>  <span class="o">+</span>\
                          <span class="s">&#39;vdw_path are None, HDF5 file is ignored.</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="k">if</span> <span class="n">ei_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">charges</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">/charges&#39;</span> <span class="o">%</span> <span class="n">ei_path</span><span class="p">][:]</span>
                    <span class="k">if</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">/radii&#39;</span> <span class="o">%</span><span class="n">ei_path</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">radii</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">/radii&#39;</span> <span class="o">%</span><span class="n">ei_path</span><span class="p">][:]</span>
                <span class="k">if</span> <span class="n">vdw_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">epsilons</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">/epsilons&#39;</span> <span class="o">%</span> <span class="n">vdw_path</span><span class="p">][:]</span>
                    <span class="n">sigmas</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">/sigmas&#39;</span> <span class="o">%</span> <span class="n">vdw_path</span><span class="p">][:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s">&#39;Unsupported file format for </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="n">fn</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">ffatypes</span><span class="o">=</span><span class="n">ffatypes</span><span class="p">,</span> <span class="n">charges</span><span class="o">=</span><span class="n">charges</span><span class="p">,</span>
                   <span class="n">radii</span><span class="o">=</span><span class="n">radii</span><span class="p">,</span> <span class="n">epsilons</span><span class="o">=</span><span class="n">epsilons</span><span class="p">,</span> <span class="n">sigmas</span><span class="o">=</span><span class="n">sigmas</span><span class="p">,</span> <span class="n">bonds</span><span class="o">=</span><span class="n">bonds</span><span class="p">,</span>
                   <span class="n">bends</span><span class="o">=</span><span class="n">bends</span><span class="p">,</span> <span class="n">diheds</span><span class="o">=</span><span class="n">diheds</span><span class="p">,</span> <span class="n">opdists</span><span class="o">=</span><span class="n">opdists</span><span class="p">,</span> <span class="n">nlist</span><span class="o">=</span><span class="n">nlist</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="System.read_uff_vdw"><a class="viewcode-back" href="../../rg_system.html#quickff.system.System.read_uff_vdw">[docs]</a>    <span class="k">def</span> <span class="nf">read_uff_vdw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Read Lennart-Jones vdW parameters from the UFF force field.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigmas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilons</span> <span class="o">=</span> <span class="n">get_uff_sigmas_epsilons</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numbers</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_check_topology</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">           Check wether all topology information (bonds, bends, dihedrals,</span>
<span class="sd">           out-of-plane patterns and neighborlist) is present and complete if</span>
<span class="sd">           necessary.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">numbers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numbers</span><span class="p">,</span> <span class="n">coordinates</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
            <span class="n">graph</span> <span class="o">=</span> <span class="n">MolecularGraph</span><span class="o">.</span><span class="n">from_geometry</span><span class="p">(</span><span class="n">molecule</span><span class="p">)</span>
            <span class="n">psf</span> <span class="o">=</span> <span class="n">PSFFile</span><span class="p">()</span>
            <span class="n">psf</span><span class="o">.</span><span class="n">add_molecule</span><span class="p">(</span><span class="n">molecule</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bonds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">psf</span><span class="o">.</span><span class="n">bonds</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bends</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">psf</span><span class="o">.</span><span class="n">bends</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">diheds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">psf</span><span class="o">.</span><span class="n">dihedrals</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">opdists</span> <span class="o">=</span> <span class="n">find_opdist_patterns</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nlist</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">neighbors</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">graph</span> <span class="o">=</span> <span class="n">MolecularGraph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">numbers</span><span class="p">)</span>
            <span class="n">psf</span> <span class="o">=</span> <span class="n">PSFFile</span><span class="p">()</span>
            <span class="n">psf</span><span class="o">.</span><span class="n">add_molecular_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bends</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bends</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">psf</span><span class="o">.</span><span class="n">bends</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diheds</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">diheds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">psf</span><span class="o">.</span><span class="n">dihedrals</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">opdists</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">opdists</span> <span class="o">=</span> <span class="n">find_opdist_patterns</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlist</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nlist</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">neighbors</span>

<div class="viewcode-block" id="System.guess_ffatypes"><a class="viewcode-back" href="../../rg_system.html#quickff.system.System.guess_ffatypes">[docs]</a>    <span class="k">def</span> <span class="nf">guess_ffatypes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">           A method to guess atom types. This will overwrite ffatypes</span>
<span class="sd">           that are already defined in the system.</span>

<span class="sd">           **Arguments:**</span>

<span class="sd">           level</span>
<span class="sd">                A string used for guessing atom types:</span>

<span class="sd">                    * low:     based on atomic number</span>
<span class="sd">                    * medium:  based on atomic number and number of neighbors</span>
<span class="sd">                    * high:    based on atomic number, number of neighbors and atomic number of neighbors</span>
<span class="sd">                    * highest: based on index in the molecule</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ffatypes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Atom types are already defined in the system.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">level</span> <span class="o">==</span> <span class="s">&#39;low&#39;</span><span class="p">:</span>
            <span class="n">atypes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pt</span><span class="p">[</span><span class="n">number</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span> <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">numbers</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">level</span> <span class="o">==</span> <span class="s">&#39;medium&#39;</span><span class="p">:</span>
            <span class="n">atypes</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">number</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numbers</span><span class="p">):</span>
                <span class="n">nind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlist</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                <span class="n">sym</span> <span class="o">=</span> <span class="n">pt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">numbers</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
                <span class="n">atype</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s%i</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sym</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nind</span><span class="p">))</span>
                <span class="n">atypes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atype</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">level</span> <span class="o">==</span> <span class="s">&#39;high&#39;</span><span class="p">:</span>
            <span class="n">atypes</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">number</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numbers</span><span class="p">):</span>
                <span class="n">nind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlist</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                <span class="n">nsym</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span>
                    <span class="n">pt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">numbers</span><span class="p">[</span><span class="n">neigh</span><span class="p">]]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">neigh</span> <span class="ow">in</span> <span class="n">nind</span>
                <span class="p">])</span>
                <span class="n">sym</span> <span class="o">=</span> <span class="n">pt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">numbers</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nsym</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">atype</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">1_</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sym</span><span class="p">,</span> <span class="n">nsym</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">nsym</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                    <span class="n">atype</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">2_</span><span class="si">%s%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sym</span><span class="p">,</span> <span class="n">nsym</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nsym</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">atype</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s%i</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sym</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nind</span><span class="p">))</span>
                    <span class="n">num_c</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="mf">1.0</span> <span class="k">for</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">nsym</span> <span class="k">if</span> <span class="n">sym</span> <span class="o">==</span> <span class="s">&#39;c&#39;</span><span class="p">])</span>
                    <span class="n">num_n</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="mf">1.0</span> <span class="k">for</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">nsym</span> <span class="k">if</span> <span class="n">sym</span> <span class="o">==</span> <span class="s">&#39;n&#39;</span><span class="p">])</span>
                    <span class="n">num_o</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="mf">1.0</span> <span class="k">for</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">nsym</span> <span class="k">if</span> <span class="n">sym</span> <span class="o">==</span> <span class="s">&#39;o&#39;</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">num_c</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">atype</span> <span class="o">+=</span> <span class="s">&#39;_c</span><span class="si">%i</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">num_c</span>
                    <span class="k">if</span> <span class="n">num_n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">atype</span> <span class="o">+=</span> <span class="s">&#39;_n</span><span class="si">%i</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">num_n</span>
                    <span class="k">if</span> <span class="n">num_o</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">atype</span> <span class="o">+=</span> <span class="s">&#39;_o</span><span class="si">%i</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">num_o</span>
                <span class="n">atypes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atype</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">level</span> <span class="o">==</span> <span class="s">&#39;highest&#39;</span><span class="p">:</span>
            <span class="n">atypes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                <span class="s">&#39;</span><span class="si">%s%i</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numbers</span><span class="p">)</span>
            <span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Invalid level, recieved </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">level</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ffatypes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">atypes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_average_charges_ffatypes</span><span class="p">()</span>
</div>
    <span class="k">def</span> <span class="nf">_average_charges_ffatypes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&#39;Take the average of the atomic charges and radii over the force field atom types&#39;</span>
        <span class="n">charges</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">radii</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">atype</span><span class="p">,</span> <span class="n">charge</span><span class="p">,</span> <span class="n">radius</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffatypes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">charges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radii</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">atype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">charges</span><span class="p">:</span>
                <span class="n">charges</span><span class="p">[</span><span class="n">atype</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">charge</span><span class="p">]</span>
                <span class="n">radii</span><span class="p">[</span><span class="n">atype</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">radius</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">charges</span><span class="p">[</span><span class="n">atype</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">charge</span><span class="p">)</span>
                <span class="n">radii</span><span class="p">[</span><span class="n">atype</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">atype</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffatypes</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">charges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">charges</span><span class="p">[</span><span class="n">atype</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">charges</span><span class="p">[</span><span class="n">atype</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">radii</span><span class="p">[</span><span class="n">atype</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">radii</span><span class="p">[</span><span class="n">atype</span><span class="p">])</span>

<div class="viewcode-block" id="System.determine_ics_from_topology"><a class="viewcode-back" href="../../rg_system.html#quickff.system.System.determine_ics_from_topology">[docs]</a>    <span class="k">def</span> <span class="nf">determine_ics_from_topology</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Method to generate IC instances corresponding to all ics</span>
<span class="sd">            present in the bonds, bends, dihedrals and opdists attributes.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">def</span> <span class="nf">sort_ffatypes</span><span class="p">(</span><span class="n">ffatypes</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">!=</span> <span class="s">&#39;opdist&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ffatypes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">ffatypes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="n">ffatypes</span>
                <span class="k">elif</span> <span class="n">ffatypes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">ffatypes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ffatypes</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">ffatypes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="n">ffatypes</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                            <span class="k">return</span> <span class="n">ffatypes</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">return</span> <span class="n">ffatypes</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">ffatypes</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">ffatypes</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ffatypes</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ffatypes</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="k">return</span> <span class="n">result</span>
        <span class="c">#Find bonds</span>
        <span class="n">number</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;bond/&#39;</span><span class="o">+</span><span class="s">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sort_ffatypes</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ffatypes</span><span class="p">[</span><span class="n">at</span><span class="p">]</span> <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="n">bond</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">number</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">number</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">number</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">ic</span> <span class="o">=</span> <span class="n">IC</span><span class="p">(</span>
                <span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">number</span><span class="p">[</span><span class="n">name</span><span class="p">]),</span> <span class="n">bond</span><span class="p">,</span> <span class="n">bond_length</span><span class="p">,</span>
                <span class="n">qunit</span><span class="o">=</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="n">kunit</span><span class="o">=</span><span class="s">&#39;kjmol/A**2&#39;</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ics</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ics</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ics</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ic</span><span class="p">]</span>
        <span class="c">#Find bends</span>
        <span class="n">number</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">bend</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bends</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;angle/&#39;</span><span class="o">+</span><span class="s">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sort_ffatypes</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ffatypes</span><span class="p">[</span><span class="n">at</span><span class="p">]</span> <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="n">bend</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">number</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">number</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">number</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">ic</span> <span class="o">=</span> <span class="n">IC</span><span class="p">(</span>
                <span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">number</span><span class="p">[</span><span class="n">name</span><span class="p">]),</span> <span class="n">bend</span><span class="p">,</span> <span class="n">bend_angle</span><span class="p">,</span>
                <span class="n">qunit</span><span class="o">=</span><span class="s">&#39;deg&#39;</span><span class="p">,</span> <span class="n">kunit</span><span class="o">=</span><span class="s">&#39;kjmol/rad**2&#39;</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ics</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ics</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ics</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ic</span><span class="p">]</span>
        <span class="c">#Find dihedrals</span>
        <span class="n">number</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">dihed</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">diheds</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bend_angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">dihed</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]],</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">175</span><span class="o">*</span><span class="n">deg</span> \
            <span class="ow">or</span> <span class="n">bend_angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">dihed</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]],</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">175</span><span class="o">*</span><span class="n">deg</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;dihed/&#39;</span><span class="o">+</span><span class="s">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sort_ffatypes</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ffatypes</span><span class="p">[</span><span class="n">at</span><span class="p">]</span> <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="n">dihed</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">number</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">number</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">number</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">ic</span> <span class="o">=</span> <span class="n">IC</span><span class="p">(</span>
                <span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">number</span><span class="p">[</span><span class="n">name</span><span class="p">]),</span> <span class="n">dihed</span><span class="p">,</span> <span class="n">dihed_angle</span><span class="p">,</span>
                <span class="n">qunit</span><span class="o">=</span><span class="s">&#39;deg&#39;</span><span class="p">,</span> <span class="n">kunit</span><span class="o">=</span><span class="s">&#39;kjmol&#39;</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ics</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ics</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ics</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ic</span><span class="p">]</span>
        <span class="c">#Find out-of-plane distances</span>
        <span class="n">number</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">opdist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">opdists</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bend_angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">opdist</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]],</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">175</span><span class="o">*</span><span class="n">deg</span> \
            <span class="ow">or</span> <span class="n">bend_angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">opdist</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]],</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="o">*</span><span class="n">deg</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;opdist/&#39;</span><span class="o">+</span><span class="s">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sort_ffatypes</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ffatypes</span><span class="p">[</span><span class="n">at</span><span class="p">]</span> <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="n">opdist</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s">&#39;opdist&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">number</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="n">number</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">number</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">ic</span> <span class="o">=</span> <span class="n">IC</span><span class="p">(</span>
                <span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">number</span><span class="p">[</span><span class="n">name</span><span class="p">]),</span> <span class="n">opdist</span><span class="p">,</span> <span class="n">opbend_dist</span><span class="p">,</span>
                <span class="n">qunit</span><span class="o">=</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="n">kunit</span><span class="o">=</span><span class="s">&#39;kjmol/A**2&#39;</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ics</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ics</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ics</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ic</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="System.print_atom_info"><a class="viewcode-back" href="../../rg_system.html#quickff.system.System.print_atom_info">[docs]</a>    <span class="k">def</span> <span class="nf">print_atom_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Print information about the atoms in the system to the screen</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">print</span> <span class="s">&#39;    ----------------------------------------------------------------------------------------------&#39;</span>
        <span class="k">print</span> <span class="s">&#39;      index   symbol   ffatype       charge [e]     radius [A]    epsilon [kJ/mol]    sigma [A]   &#39;</span>
        <span class="k">print</span> <span class="s">&#39;    ----------------------------------------------------------------------------------------------&#39;</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">ffatype</span><span class="p">,</span> <span class="n">charge</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> \
        <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numbers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ffatypes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">charges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radii</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilons</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmas</span><span class="p">)):</span>
            <span class="n">index_fmt</span>   <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>        <span class="o">+</span> <span class="s">&#39; &#39;</span><span class="o">*</span><span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)))</span>
            <span class="n">symbol_fmt</span>  <span class="o">=</span> <span class="n">pt</span><span class="p">[</span><span class="n">number</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span> <span class="o">+</span> <span class="s">&#39; &#39;</span><span class="o">*</span><span class="p">(</span><span class="mi">6</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="n">number</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="p">))</span>
            <span class="n">ffatype_fmt</span> <span class="o">=</span> <span class="n">ffatype</span>           <span class="o">+</span> <span class="s">&#39; &#39;</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">ffatype</span><span class="p">))</span>
            <span class="k">print</span> <span class="s">&#39;      </span><span class="si">%s</span><span class="s">   </span><span class="si">%s</span><span class="s">   </span><span class="si">%s</span><span class="s">      </span><span class="si">% 6.3f</span><span class="s">        </span><span class="si">%6.3f</span><span class="s">          </span><span class="si">%6.3f</span><span class="s">          </span><span class="si">%6.3f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">index_fmt</span><span class="p">,</span> <span class="n">symbol_fmt</span><span class="p">,</span> <span class="n">ffatype_fmt</span><span class="p">,</span> <span class="n">charge</span><span class="p">,</span> <span class="n">radius</span><span class="o">/</span><span class="n">angstrom</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">/</span><span class="n">kjmol</span><span class="p">,</span> <span class="n">sigma</span><span class="o">/</span><span class="n">angstrom</span>
            <span class="p">)</span>
        <span class="k">print</span> <span class="s">&#39;    ----------------------------------------------------------------------------------------------&#39;</span>
</div>
<div class="viewcode-block" id="System.print_ic_info"><a class="viewcode-back" href="../../rg_system.html#quickff.system.System.print_ic_info">[docs]</a>    <span class="k">def</span> <span class="nf">print_ic_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Print information about the internal coordinate in the system</span>
<span class="sd">            to the screen</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">print</span> <span class="s">&#39;    -----------------------------------------------------&#39;</span>
        <span class="k">print</span> <span class="s">&#39;                            icname     indices           &#39;</span>
        <span class="k">print</span> <span class="s">&#39;    -----------------------------------------------------&#39;</span>
        <span class="k">for</span> <span class="n">icname</span><span class="p">,</span> <span class="n">ics</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ics</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">ic</span> <span class="ow">in</span> <span class="n">ics</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&#39;    </span><span class="si">%30s</span><span class="s">    &#39;</span> <span class="o">%</span> <span class="n">icname</span> <span class="o">+</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="p">[</span><span class="s">&#39;</span><span class="si">%3i</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">index</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">ic</span><span class="o">.</span><span class="n">indexes</span><span class="p">]</span>
                <span class="p">)</span>
        <span class="k">print</span> <span class="s">&#39;    -----------------------------------------------------&#39;</span>
</div>
<div class="viewcode-block" id="System.dump"><a class="viewcode-back" href="../../rg_system.html#quickff.system.System.dump">[docs]</a>    <span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Dump system to a MolMod checkpoint file.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">sample</span><span class="p">[</span><span class="s">&#39;numbers&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">numbers</span>
        <span class="n">sample</span><span class="p">[</span><span class="s">&#39;charges&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charges</span>
        <span class="n">sample</span><span class="p">[</span><span class="s">&#39;radii&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radii</span>
        <span class="n">sample</span><span class="p">[</span><span class="s">&#39;epsilons&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilons</span>
        <span class="n">sample</span><span class="p">[</span><span class="s">&#39;sigmas&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmas</span>
        <span class="n">sample</span><span class="p">[</span><span class="s">&#39;ffatypes&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ffatypes</span>
        <span class="n">sample</span><span class="p">[</span><span class="s">&#39;masses&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pt</span><span class="p">[</span><span class="n">Z</span><span class="p">]</span><span class="o">.</span><span class="n">mass</span> <span class="k">for</span> <span class="n">Z</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">numbers</span><span class="p">])</span>
        <span class="n">sample</span><span class="p">[</span><span class="s">&#39;bonds&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds</span>
        <span class="n">sample</span><span class="p">[</span><span class="s">&#39;bends&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bends</span>
        <span class="n">sample</span><span class="p">[</span><span class="s">&#39;dihedrals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">diheds</span>
        <span class="n">sample</span><span class="p">[</span><span class="s">&#39;opdists&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opdists</span>
        <span class="n">sample</span><span class="p">[</span><span class="s">&#39;pos&#39;</span><span class="p">]</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref</span><span class="o">.</span><span class="n">coords</span>
        <span class="n">sample</span><span class="p">[</span><span class="s">&#39;grad&#39;</span><span class="p">]</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref</span><span class="o">.</span><span class="n">grad</span>
        <span class="n">sample</span><span class="p">[</span><span class="s">&#39;hess&#39;</span><span class="p">]</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref</span><span class="o">.</span><span class="n">hess</span>
        <span class="n">dump_chk</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">sample</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="System.dump_charges_yaff"><a class="viewcode-back" href="../../rg_system.html#quickff.system.System.dump_charges_yaff">[docs]</a>    <span class="k">def</span> <span class="nf">dump_charges_yaff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">ei</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;w&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Write or append charges to a file in Yaff format.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# Fixed charges&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# =============&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&quot;# Mathematical form: q_A = q_0A + sum&#39;_B p_BA&quot;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# where q0_A is the reference charge of atom A. It is mostly zero, sometimes a&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# non-zero integer. The total charge of a fragment is the sum of all reference&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# charges. The parameter p_BA is the charge transfered from B to A. Such charge&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# transfers are only carried out over bonds in the FF topology.&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# The charge on an atom is modeled as a Gaussian distribution. The spread on the&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# Gaussian is called the radius R. When the radius is set to zero, point charges&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# will be used instead of smeared charges.&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;FIXQ:UNIT Q0 e&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;FIXQ:UNIT P e&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;FIXQ:UNIT R angstrom&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;FIXQ:SCALE 1 </span><span class="si">%3.1f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">ei</span><span class="o">.</span><span class="n">scales</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;FIXQ:SCALE 2 </span><span class="si">%3.1f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">ei</span><span class="o">.</span><span class="n">scales</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;FIXQ:SCALE 3 </span><span class="si">%3.1f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">ei</span><span class="o">.</span><span class="n">scales</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;FIXQ:DIELECTRIC 1.0&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# Atomic parameters&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# ----------------------------------------------------&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# KEY        label  Q_0A              R_A&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# ----------------------------------------------------&#39;</span>
        <span class="n">added</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">atype</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">radius</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffatypes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">charges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radii</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">atype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">added</span><span class="p">:</span>
                <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;FIXQ:ATOM </span><span class="si">%8s</span><span class="s"> </span><span class="si">% 13.10f</span><span class="s">  </span><span class="si">%12.10f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">atype</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">radius</span><span class="o">/</span><span class="n">angstrom</span><span class="p">)</span>
                <span class="n">added</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atype</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="System.dump_vdw_yaff"><a class="viewcode-back" href="../../rg_system.html#quickff.system.System.dump_vdw_yaff">[docs]</a>    <span class="k">def</span> <span class="nf">dump_vdw_yaff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">vdw</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;w&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Write or append van der Waals parameters to a file in Yaff format.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">vdw</span><span class="o">.</span><span class="n">pot</span><span class="o">.</span><span class="n">kind</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;MM3Buckingham&#39;</span><span class="p">):</span>
            <span class="n">pot_id</span> <span class="o">=</span> <span class="s">&#39;MM3&#39;</span>
        <span class="k">elif</span> <span class="n">vdw</span><span class="o">.</span><span class="n">pot</span><span class="o">.</span><span class="n">kind</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;LennartJones&#39;</span><span class="p">):</span>
            <span class="n">pot_id</span> <span class="o">=</span> <span class="s">&#39;LJ&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;VDWPart in model has unsupported pot_kind: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="n">vdw</span><span class="o">.</span><span class="n">kind</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# van der Waals&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;#==============&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# The following mathemetical form is supported:&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;#  - MM3:   EPSILON*(1.84e5*exp(-12*r/SIGMA)-2.25*(SIGMA/r)^6)&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;#  - LJ:    4.0*EPSILON*((SIGMA/r)^12 - (SIGMA/r)^6)&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;#  - PAULI: A*exp(-B*r)&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">:UNIT SIGMA angstrom&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">pot_id</span><span class="p">)</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">:UNIT EPSILON kjmol&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">pot_id</span><span class="p">)</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">:SCALE 1 </span><span class="si">%4.2f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pot_id</span><span class="p">,</span> <span class="n">vdw</span><span class="o">.</span><span class="n">scales</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">:SCALE 2 </span><span class="si">%4.2f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pot_id</span><span class="p">,</span> <span class="n">vdw</span><span class="o">.</span><span class="n">scales</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">:SCALE 3 </span><span class="si">%4.2f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pot_id</span><span class="p">,</span> <span class="n">vdw</span><span class="o">.</span><span class="n">scales</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# -------------------------------------------&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# KEY    ffatype  SIGMA         EPSILON&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;# -------------------------------------------&#39;</span>
        <span class="n">added</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">atype</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">epsilon</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffatypes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilons</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">atype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">added</span><span class="p">:</span>
                <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">f</span><span class="p">,</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">:PARS </span><span class="si">%8s</span><span class="s"> </span><span class="si">% .10f</span><span class="s"> </span><span class="si">% .10f</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">pot_id</span><span class="p">,</span> <span class="n">atype</span><span class="p">,</span> <span class="n">sigma</span><span class="o">/</span><span class="n">angstrom</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">/</span><span class="n">kjmol</span><span class="p">)</span>
                <span class="n">added</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atype</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">QuickFF 1.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Louis Vanduyfhuys.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>