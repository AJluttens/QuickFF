<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tutorial 1 - Benzene &mdash; QuickFF 2.0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="QuickFF 2.0.1 documentation" href="index.html" />
    <link rel="next" title="1. quickff.cost – Least-Square cost function for hessian matching" href="rg_module.html" />
    <link rel="prev" title="2. Generating Yaff parameter file for the electrostatic contribution" href="ug_inputei.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rg_module.html" title="1. quickff.cost – Least-Square cost function for hessian matching"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ug_inputei.html" title="2. Generating Yaff parameter file for the electrostatic contribution"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">QuickFF 2.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tutorial-1-benzene">
<h1>Tutorial 1 - Benzene<a class="headerlink" href="#tutorial-1-benzene" title="Permalink to this headline">¶</a></h1>
<p>This tutorial will describe in detail the use of QuickFF to generate a force
field for benzene. This tutorial assumes that the following input files are
available (examples of such file are provided with the source code in the
directory <cite>share/systems/benzene</cite>):</p>
<ul>
<li><dl class="first docutils">
<dt>gaussian.fchk</dt>
<dd><p class="first">A Gaussian Formatted Checkpoint file containing the ab initio equilibrium
geometry and ab initio Hessian in equilibrium. This file can be generated
by performing a freq job in Gaussian using your level of theory and basis
set of choice. The following line should be added prior to the route
section (i.e. the lines starting with #):</p>
<div class="highlight-python"><div class="highlight"><pre>%chk=gaussian.chk
</pre></div>
</div>
<p>When the calculation terminated succesfully, make the fchk file using the
following command:</p>
<div class="last highlight-python"><div class="highlight"><pre>formchk gaussian.chk gaussian.fchk
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>gaussian_wpart.h5</dt>
<dd><p class="first">A HDF5 file containing the atomic charges. Such a file can, for example, be
generated using <a class="reference external" href="http://molmod.github.com/horton/">Horton</a>. To determine
the path in the HDF5 file to these charges, one can use the <cite>h5dump</cite>
command (part of the Linux package <cite>hdf5-tools</cite>):</p>
<div class="highlight-python"><div class="highlight"><pre>h5dump -n gaussian_wpart.h5
</pre></div>
</div>
<p>The output of this command for the gaussian_wpart.h5 file provided in the
directory <cite>share/systems/benzene</cite> is:</p>
<div class="highlight-text"><div class="highlight"><pre>HDF5 &quot;/home/louis/build/quickff/share/systems/benzene/gaussian_wpart.h5&quot; {
FILE_CONTENTS {
 group      /
 group      /system
 dataset    /system/coordinates
 group      /system/extra
 dataset    /system/extra/energy
 dataset    /system/extra/mulliken_charges
 dataset    /system/numbers
 group      /system/obasis
 dataset    /system/obasis/alphas
 dataset    /system/obasis/centers
 dataset    /system/obasis/con_coeffs
 dataset    /system/obasis/nprims
 dataset    /system/obasis/shell_map
 dataset    /system/obasis/shell_types
 dataset    /system/pseudo_numbers
 group      /system/wfn
 group      /system/wfn/dm_alpha
 dataset    /system/wfn/dm_alpha/array
 group      /system/wfn/exp_alpha
 dataset    /system/wfn/exp_alpha/coeffs
 dataset    /system/wfn/exp_alpha/energies
 dataset    /system/wfn/exp_alpha/occupations
 dataset    /system/wfn/nbasis
 dataset    /system/wfn/norb
 group      /system/wfn/occ_model
 dataset    /system/wfn/occ_model/nalpha
 dataset    /system/wfn/occ_model/nbeta
 group      /wpart
 group      /wpart/h
 dataset    /wpart/h/c6s
 dataset    /wpart/h/cartesian_multipoles
 dataset    /wpart/h/charges
 dataset    /wpart/h/populations
 dataset    /wpart/h/pseudo_populations
 dataset    /wpart/h/radial_moments
 dataset    /wpart/h/volume_ratios
 dataset    /wpart/h/volumes
 group      /wpart/he
 dataset    /wpart/he/c6s
 dataset    /wpart/he/cartesian_multipoles
 dataset    /wpart/he/change
 dataset    /wpart/he/charges
 dataset    /wpart/he/history_charges
 dataset    /wpart/he/history_propars
 dataset    /wpart/he/niter
 dataset    /wpart/he/populations
 dataset    /wpart/he/pseudo_populations
 dataset    /wpart/he/radial_moments
 dataset    /wpart/he/volume_ratios
 dataset    /wpart/he/volumes
 group      /wpart/hi
 dataset    /wpart/hi/c6s
 dataset    /wpart/hi/cartesian_multipoles
 dataset    /wpart/hi/change
 dataset    /wpart/hi/charges
 dataset    /wpart/hi/history_charges
 dataset    /wpart/hi/history_propars
 dataset    /wpart/hi/niter
 dataset    /wpart/hi/populations
 dataset    /wpart/hi/pseudo_populations
 dataset    /wpart/hi/radial_moments
 dataset    /wpart/hi/volume_ratios
 dataset    /wpart/hi/volumes
 }
}
</pre></div>
</div>
<p class="last">From this output, we can conclude that, for example, Hirshfeld-I charges can
be found in the path <cite>/wpart/hi/charges</cite>.</p>
</dd>
</dl>
</li>
</ul>
<div class="section" id="covalent-force-field-without-non-bonding-terms">
<h2>Covalent force field without non-bonding terms<a class="headerlink" href="#covalent-force-field-without-non-bonding-terms" title="Permalink to this headline">¶</a></h2>
<p>As a first example, we will derive a force field containing only covalent terms.
No electrostatic nor van der Waals interactions will be included in the force
field. Furthermore, we use the <a class="reference internal" href="ug_script.html#seclab-ug-atype-estimator"><em>built-in feature</em></a> to automatically determine atom types according to
the level <cite>low</cite> (for benzene it does not make any difference which level is
chosen). This can very easily be done using the <a class="reference internal" href="rg_scripts.html#seclab-rg-scripts-qff"><em>qff.py</em></a> script (documentation on the available options can be
accessed by <cite>qff.py</cite> <em class="xref std std-option">--help</em>):</p>
<div class="highlight-python"><div class="highlight"><pre>qff.py --ffatypes=low gaussian.fchk
</pre></div>
</div>
<p>The script will dump all relevant information to the screen, for this tutorial,
the output is as follows:</p>
<div class="highlight-text"><div class="highlight"><pre>________________/\\\_________/\\\\\\\\\\\\\\\__/\\\\\\\\\\\\\\\_________________
______________/\\\\/\\\\_____\/\\\///////////__\/\\\///////////_________________
_____________/\\\//\////\\\___\/\\\_____________\/\\\___________________________
_____________/\\\______\//\\\__\/\\\\\\\\\\\_____\/\\\\\\\\\\\__________________
_____________\//\\\______/\\\___\/\\\///////______\/\\\///////__________________
_______________\///\\\\/\\\\/____\/\\\_____________\/\\\________________________
__________________\////\\\//______\/\\\_____________\/\\\_______________________
______________________\///\\\\\\___\/\\\_____________\/\\\______________________
_________________________\//////____\///______________\///______________________

                            Welcom to QuickFF 2.0
   a Python package to quickly derive force fields from ab initio input data

                                 Written by
     Louis Vanduyfhuys(1)*, Steven Vandenbrande(1) and Toon Verstraelen(1)

         (1) Center for Molecular Modeling, Ghent University Belgium.
                   * mailto: Louis.Vanduyfhuys@UGent.be


 USER               louis
 MACHINE            Linux molmod91 4.2.0-34-generic #39-Ubuntu SMP Thu Mar 10 
 MACHINE            22:13:01 UTC 2016 x86_64
 TIME               2016-03-24 18:37:51.110196
 PYTHON VERSION     2.7.10 (default, Oct 14 2015, 16:09:02) [GCC 5.2.1 20151010]
 CURRENT DIR        /home/louis/build/quickff/doc
 COMMAND LINE       /home/louis/.local/bin/qff.py --ffatypes=low /home/louis/
 COMMAND LINE       build/quickff/share/systems/benzene/gaussian.fchk

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 QFF    Initializing system
 QFF    Initializing Second order taylor reference for ai

 PROG   Initializing program

 VAL    Initializing valence force field
 VAL    Added 12 Harmonic bond terms
 VAL    Added 18 Harmonic bend terms
 VAL    Added 24 Cosine dihedral terms
 VAL    Added 6 Harmonic and 0 SquareHarmonic out-of-plane distance terms

 EQSET  Resetting system coordinates to ab initio ref
 EQSET  Setting rest values to AI equilibrium values for tasks EQ_RV

 EQSET  Averaging force field parameters over master and slaves

 PTGEN  Resetting system coordinates to ab initio ref
 PTGEN  Constructing trajectories

 PTEST  Resetting system coordinates to ab initio ref
 PTEST  Estimating FF parameters from perturbation trajectories

 PTEST  Averaging force field parameters over master and slaves

 CRINI  Resetting system coordinates to ab initio ref
 CRINI  Added 18 cross terms for angle patterns

 HCEST  Resetting system coordinates to ab initio ref
 HCEST  Estimating force constants from Hessian cost for tasks HC_FC_DIAG HC_FC_
 HCEST  CROSS

 PTEST  Resetting system coordinates to ab initio ref
 PTEST  Estimating FF parameters from perturbation trajectories with valence 
 PTEST  reference

 PTEST  Averaging force field parameters over master and slaves

 HCEST  Resetting system coordinates to ab initio ref
 HCEST  Estimating force constants from Hessian cost for tasks HC_FC_DIAG HC_FC_
 HCEST  CROSS


        BondHarm/C.C (kjmol/A^2  A)                                             
            fc =  3975 ± .000    rv = 1.394 ± .000

        BondHarm/C.H (kjmol/A^2  A)                                             
            fc =  3385 ± .000    rv = 1.084 ± .000

        BendAHarm/C.C.C (kjmol/rad^2  deg)                                      
            fc = 617.6 ± .000    rv = 120.0 ± .000

        BendAHarm/C.C.H (kjmol/rad^2  deg)                                      
            fc = 291.7 ± .000    rv = 119.9 ± .000

        Torsion/C.C.C.C (au  kjmol  deg)                                        
            fc = 32.0 ± 0.0    rv = .000 ± 0.0    m = 2

        Torsion/C.C.C.H (au  kjmol  deg)                                        
            fc = 32.1 ± .00    rv = .000 ± 0.0    m = 2

        Torsion/H.C.C.H (au  kjmol  deg)                                        
            fc = 13.0 ± 0.0    rv = .000 ± 0.0    m = 2

        Oopdist/C.C.H.C (kjmol/A^2  A)                                          
            fc = 274.5 ± .000    rv = .0000 ± .000

        Cross/C.C.C/b0a (kjmol/(A*rad)  A  deg)                                 
            fc = 9.69 ± .0    rv0 = 1.39 ± 0.0    rv0 =  120 ± 0.0

        Cross/C.C.C/b1a (kjmol/(A*rad)  A  deg)                                 
            fc = 9.80 ± .0    rv0 = 1.39 ± 0.0    rv0 =  120 ± 0.0

        Cross/C.C.C/bb (kjmol/A^2  A  A)                                        
            fc =  595 ± .0    rv0 = 1.39 ± 0.0    rv0 = 1.39 ± 0.0

        Cross/C.C.H/b0a (kjmol/(A*rad)  A  deg)                                 
            fc = 63.0 ± .0    rv0 = 1.39 ± .00    rv0 =  119 ± .00

        Cross/C.C.H/b1a (kjmol/(A*rad)  A  deg)                                 
            fc =  144 ± .0    rv0 = 1.08 ± .00    rv0 =  119 ± .00

        Cross/C.C.H/bb (kjmol/A^2  A  A)                                        
            fc =  120 ± .0    rv0 = 1.39 ± .00    rv0 = 1.08 ± .00

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


 TIMING Initializing                    0:00:00.095755
 TIMING Equil Set RV                    0:00:00.007026
 TIMING PT Generate                     0:00:18.295780
 TIMING PT Estimate                     0:00:00.114886
 TIMING HC Estimate FC                  0:00:00.451981
 TIMING PT plot energy                  0:00:00.000013
 TIMING PT dump XYZ                     0:00:00.000005

__/\\\__________________________________________________________________/\\\____
  \ \\\                                                                 \ \\\
   \ \\\     End of file. Thanks for using QuickFF! Come back soon!!     \ \\\
____\///__________________________________________________________________\///__
</pre></div>
</div>
<p>The logger will dump to following information to the screen (or a file if the
<em class="xref std std-option">--logfile</em> option was used):</p>
<ul>
<li><dl class="first docutils">
<dt>Machine environment:</dt>
<dd><p class="first last">This section contains some general information about the machine environment
on which you ran the quickff job. It contains the user name, machine info,
starting time of job, Python version, current directory and the command used
to envoke quickff.</p>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="force-field-with-electrostatics">
<h2>Force field with electrostatics<a class="headerlink" href="#force-field-with-electrostatics" title="Permalink to this headline">¶</a></h2>
<p>TODO</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial 1 - Benzene</a><ul>
<li><a class="reference internal" href="#covalent-force-field-without-non-bonding-terms">Covalent force field without non-bonding terms</a></li>
<li><a class="reference internal" href="#force-field-with-electrostatics">Force field with electrostatics</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ug_inputei.html"
                        title="previous chapter">2. Generating Yaff parameter file for the electrostatic contribution</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="rg_module.html"
                        title="next chapter">1. <tt class="docutils literal"><span class="pre">quickff.cost</span></tt> &#8211; Least-Square cost function for hessian matching</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/tu_benzene.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rg_module.html" title="1. quickff.cost – Least-Square cost function for hessian matching"
             >next</a> |</li>
        <li class="right" >
          <a href="ug_inputei.html" title="2. Generating Yaff parameter file for the electrostatic contribution"
             >previous</a> |</li>
        <li><a href="index.html">QuickFF 2.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2016, Louis Vanduyfhuys.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>