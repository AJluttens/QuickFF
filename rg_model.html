<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2. Module quickff.model – Definition of the force field model &mdash; QuickFF 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="QuickFF 1.0 documentation" href="index.html" />
    <link rel="next" title="3. Module quickff.program – Management of the entire program" href="rg_program.html" />
    <link rel="prev" title="1. Module quickff.system – Representation of molecular systems" href="rg_system.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rg_program.html" title="3. Module quickff.program – Management of the entire program"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="rg_system.html" title="1. Module quickff.system – Representation of molecular systems"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">QuickFF 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-quickff.model">
<span id="module-quickff-model-definition-of-the-force-field-model"></span><h1>2. Module <tt class="docutils literal"><span class="pre">quickff.model</span></tt> &#8211; Definition of the force field model<a class="headerlink" href="#module-quickff.model" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="quickff.model.Model">
<em class="property">class </em><tt class="descclassname">quickff.model.</tt><tt class="descname">Model</tt><big>(</big><em>ai</em>, <em>val</em>, <em>ei</em>, <em>vdw</em><big>)</big><a class="reference internal" href="_modules/quickff/model.html#Model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>A class defining the ab initio total energy of the system,
the force field electrostatic contribution and the
force field valence contribution.</p>
<p><strong>Arguments</strong></p>
<dl class="docutils">
<dt>ai</dt>
<dd>A model for the ab initio total energy, should be an instance
of AIPart</dd>
<dt>val</dt>
<dd>an instance of the ValencePart class containing all details
of the force field valence terms.</dd>
<dt>ei</dt>
<dd>A model for the force field electrostatic energy, should be
an instance of EIPart</dd>
<dt>vdw</dt>
<dd>A model for the force field van der Waals energy, should be
an instance of VDWPart</dd>
</dl>
<dl class="classmethod">
<dt id="quickff.model.Model.from_system">
<em class="property">classmethod </em><tt class="descname">from_system</tt><big>(</big><em>system, ai_project=True, ic_ids=['all'], ei_scales=[0.0, 0.0, 1.0], ei_pot_kind='Harmonic', vdw_scales=[0.0, 0.0, 1.0], vdw_pot_kind='Harmonic'</em><big>)</big><a class="reference internal" href="_modules/quickff/model.html#Model.from_system"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.Model.from_system" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Arguments</strong></p>
<dl class="docutils">
<dt>system</dt>
<dd>An instance of the System class containing all the information
of the system.</dd>
</dl>
<p><strong>Optional Arguments</strong></p>
<dl class="docutils">
<dt>ai_project</dt>
<dd>If True, project the translational and rotational degrees of
freedom out of the hessian.</dd>
<dt>ic_ids</dt>
<dd>A list of identifiers specifying which icnames should be
included in the Valence Part. Each identifier can be a specific
IC name such as &#8216;bond/C3_cc.H1_c&#8217; or can be one of the following
strings: &#8216;bonds&#8217;, &#8216;angles&#8217;, &#8216;diheds&#8217;, &#8216;opdists&#8217; or &#8216;all&#8217;.</dd>
<dt>ei_scales</dt>
<dd>a list containing the scales for the 1-2, 1-3 and 1-4
contribution to the electrostatic interactions</dd>
<dt>ei_pot_kind</dt>
<dd>a string defining the potential kind of the electrostatic
interactions. Can be &#8216;CoulPoint&#8217;, &#8216;CoulGauss&#8217;, &#8216;HarmPoint&#8217;
&#8216;HarmGauss&#8217; or &#8216;Zero&#8217;. If &#8216;CoulPoint&#8217;/&#8217;CoulGauss&#8217; is chosen,
the exact Coulombic potential between point/gaussian charges
will be used to evaluate EI interactions. If
&#8216;HarmPoint&#8217;/&#8217;HarmGauss&#8217; is chosen, a second order Taylor
expansion of the Coulomb potential is used. Harmonic is a lot
faster and should already give accurate results.</dd>
<dt>vdw_scales</dt>
<dd>a list containing the scales for the 1-2, 1-3 and 1-4
contribution to the van der Waals interactions</dd>
<dt>vdw_pot_kind</dt>
<dd>a string defining the potential kind of the van der Waals
interactions. Can be &#8216;LJ&#8217;, &#8216;MM3&#8217;, &#8216;HarmLJ&#8217;, &#8216;HarmMM3&#8217; or &#8216;Zero&#8217;.
If LJ/MM3 is chosen, the exact Lennard-Jones/MM3-Buckingham
potential will be used to evaluate van der Waals interactions.
If HarmLJ/HarmMM3 is chosen, a second order Taylor expansion of
the LJ/MM3 potential is used. Harmonic is a lot faster and
should already give accurate results.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="quickff.model.Model.print_info">
<tt class="descname">print_info</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/quickff/model.html#Model.print_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.Model.print_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Print some basic information about the model.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="quickff.model.AIPart">
<em class="property">class </em><tt class="descclassname">quickff.model.</tt><tt class="descname">AIPart</tt><big>(</big><em>pot</em>, <em>project=True</em><big>)</big><a class="reference internal" href="_modules/quickff/model.html#AIPart"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.AIPart" title="Permalink to this definition">¶</a></dt>
<dd><p>A class for describing the Ab initio PES.</p>
<p><strong>Arguments</strong></p>
<dl class="docutils">
<dt>pot</dt>
<dd>An instance of HarmonicPot defining the second order Taylor
expansion of the ab initio energy.</dd>
</dl>
<p><strong>Optional Arguments</strong></p>
<dl class="docutils">
<dt>project</dt>
<dd>Boolean specifying wheter or not the translational and
rotational degrees of freedom should be projected out of the
ab initio Hessian [default=True].</dd>
</dl>
<dl class="classmethod">
<dt id="quickff.model.AIPart.from_system">
<em class="property">classmethod </em><tt class="descname">from_system</tt><big>(</big><em>system</em>, <em>project=True</em><big>)</big><a class="reference internal" href="_modules/quickff/model.html#AIPart.from_system"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.AIPart.from_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to construct a AIPart instance from a System instance.</p>
<p><strong>Arguments</strong></p>
<dl class="docutils">
<dt>system</dt>
<dd>An instance of the System class containing all system information.
The attributes system.ref.coords, system.ref.grad and
system.ref.hess (or system.ref.phess in case project=True) will be
used to construct the Taylor expansion.</dd>
</dl>
<p><strong>Optional Arguments</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>project</dt>
<dd>Boolean specifying wheter or not the translational and
rotational degrees of freedom should be projected out of the
ab initio Hessian [default=True].</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="quickff.model.AIPart.print_info">
<tt class="descname">print_info</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/quickff/model.html#AIPart.print_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.AIPart.print_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to dump basic information about the ab initio model.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="quickff.model.EIPart">
<em class="property">class </em><tt class="descclassname">quickff.model.</tt><tt class="descname">EIPart</tt><big>(</big><em>pot</em>, <em>scales</em><big>)</big><a class="reference internal" href="_modules/quickff/model.html#EIPart"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.EIPart" title="Permalink to this definition">¶</a></dt>
<dd><p>A class for describing the electrostatic part to the FF PES.</p>
<p><strong>Arguments</strong></p>
<dl class="docutils">
<dt>pot</dt>
<dd>An instance of HarmonicPot, CoulPointPot or CoulGaussPot
defining the electrostatic contribution to the force field
energy.</dd>
<dt>scales</dt>
<dd>list of 3 floats specifying the scales of the electrostatic
interactions between 1-2, 1-3 and 1-4 atom pairs.</dd>
</dl>
<dl class="classmethod">
<dt id="quickff.model.EIPart.from_system">
<em class="property">classmethod </em><tt class="descname">from_system</tt><big>(</big><em>system</em>, <em>scales</em>, <em>pot_kind</em><big>)</big><a class="reference internal" href="_modules/quickff/model.html#EIPart.from_system"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.EIPart.from_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to construct a EIPart instance from a System instance. All
necessary information will be extraced from the system instance.</p>
<p><strong>Arguments</strong></p>
<dl class="docutils">
<dt>system</dt>
<dd>An instance of the System class from which charges, radii,
coordinates, ... will be read.</dd>
<dt>scales</dt>
<dd>list of 3 floats specifying the scales of the electrostatic
interactions between 1-2, 1-3 and 1-4 atom pairs.</dd>
<dt>pot_kind</dt>
<dd>A string defining the electrostatic potential. Should be one of:
Zero, HarmPoint, HarmGauss, CoulPoint or CoulGauss.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="quickff.model.EIPart.print_info">
<tt class="descname">print_info</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/quickff/model.html#EIPart.print_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.EIPart.print_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to dump basic information about the electrostatic part.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="quickff.model.ValencePart">
<em class="property">class </em><tt class="descclassname">quickff.model.</tt><tt class="descname">ValencePart</tt><big>(</big><em>pot</em><big>)</big><a class="reference internal" href="_modules/quickff/model.html#ValencePart"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.ValencePart" title="Permalink to this definition">¶</a></dt>
<dd><p>A class managing all valence force field terms. This class will mainly
be used in the second step of the fitting procedure, when the force
constants are refined at fixed values for the rest values.</p>
<p><strong>Arguments</strong></p>
<dl class="docutils">
<dt>pot</dt>
<dd>An instance of TermListPot defining the covalent contribution
to the force field energy.</dd>
</dl>
<dl class="method">
<dt id="quickff.model.ValencePart.determine_dihedral_potentials">
<tt class="descname">determine_dihedral_potentials</tt><big>(</big><em>system</em>, <em>marge2=0.2617993877991494</em>, <em>marge3=0.2617993877991494</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="_modules/quickff/model.html#ValencePart.determine_dihedral_potentials"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.ValencePart.determine_dihedral_potentials" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the potential of every dihedral based on the values of
the dihedral angles in the geometry. First try if a cosine potential
of the form 0.5*K*[1 - cos(m(psi-psi0))] works well with m=2,3 and
psi0 = 0,pi/m. If this doesn&#8217;t work, raise a warning and ignore
dihedral.</p>
</dd></dl>

<dl class="classmethod">
<dt id="quickff.model.ValencePart.from_system">
<em class="property">classmethod </em><tt class="descname">from_system</tt><big>(</big><em>system, ic_ids=['all']</em><big>)</big><a class="reference internal" href="_modules/quickff/model.html#ValencePart.from_system"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.ValencePart.from_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to construct a ValencePart instance from a System instance.
All necessary information will be extraced from the system instance.</p>
<p><strong>Arguments</strong></p>
<dl class="docutils">
<dt>system</dt>
<dd>An instance of the System class from which internal coordinates
will be read.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="quickff.model.ValencePart.get_fcs">
<tt class="descname">get_fcs</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/quickff/model.html#ValencePart.get_fcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.ValencePart.get_fcs" title="Permalink to this definition">¶</a></dt>
<dd><p>A method to return the force constants of the valence terms. The
ordering of fcs in the output will be the same as the ordering of
sorted(system.ics.keys()).</p>
</dd></dl>

<dl class="method">
<dt id="quickff.model.ValencePart.get_fftable">
<tt class="descname">get_fftable</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/quickff/model.html#ValencePart.get_fftable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.ValencePart.get_fftable" title="Permalink to this definition">¶</a></dt>
<dd><p>A method to return a FFTable instance containing all force field
parameters (force constants and rest values).</p>
</dd></dl>

<dl class="attribute">
<dt id="quickff.model.ValencePart.nterms">
<tt class="descname">nterms</tt><a class="headerlink" href="#quickff.model.ValencePart.nterms" title="Permalink to this definition">¶</a></dt>
<dd><p>Method that returns the number of valence terms in the force field.</p>
</dd></dl>

<dl class="method">
<dt id="quickff.model.ValencePart.print_info">
<tt class="descname">print_info</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/quickff/model.html#ValencePart.print_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.ValencePart.print_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to dump basic information about the covalent part.</p>
</dd></dl>

<dl class="method">
<dt id="quickff.model.ValencePart.update_fcs">
<tt class="descname">update_fcs</tt><big>(</big><em>fcs</em><big>)</big><a class="reference internal" href="_modules/quickff/model.html#ValencePart.update_fcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.ValencePart.update_fcs" title="Permalink to this definition">¶</a></dt>
<dd><p>A method to update the force constants of the valence terms.</p>
<p><strong>Aruments</strong></p>
<dl class="docutils">
<dt>fcs</dt>
<dd>A numpy array containing the new force constants. The ordering
of fcs in the input argument should be the same as the ordering
of sorted(system.ics.keys()).</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="quickff.model.ValencePart.update_fftable">
<tt class="descname">update_fftable</tt><big>(</big><em>fftab</em><big>)</big><a class="reference internal" href="_modules/quickff/model.html#ValencePart.update_fftable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.ValencePart.update_fftable" title="Permalink to this definition">¶</a></dt>
<dd><p>A method to update all force field parameters (force constants and
rest values) with the values from the given FFTable.</p>
<p><strong>Arguments</strong></p>
<dl class="docutils">
<dt>fftab</dt>
<dd>An instance of the FFTable class containing force field
parameters.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="quickff.model.ZeroPot">
<em class="property">class </em><tt class="descclassname">quickff.model.</tt><tt class="descname">ZeroPot</tt><a class="reference internal" href="_modules/quickff/model.html#ZeroPot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.ZeroPot" title="Permalink to this definition">¶</a></dt>
<dd><p>A class defining a zero-valued potential to describe any part of the AI
or FF energy.</p>
</dd></dl>

<dl class="class">
<dt id="quickff.model.HarmonicPot">
<em class="property">class </em><tt class="descclassname">quickff.model.</tt><tt class="descname">HarmonicPot</tt><big>(</big><em>kind</em>, <em>coords0</em>, <em>energy0</em>, <em>grad0</em>, <em>hess0</em><big>)</big><a class="reference internal" href="_modules/quickff/model.html#HarmonicPot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.HarmonicPot" title="Permalink to this definition">¶</a></dt>
<dd><p>A class defining a harmonic potential to describe any part of the AI or
FF energy.</p>
</dd></dl>

<dl class="class">
<dt id="quickff.model.CoulPointPot">
<em class="property">class </em><tt class="descclassname">quickff.model.</tt><tt class="descname">CoulPointPot</tt><big>(</big><em>charges</em>, <em>scales</em>, <em>scaled_pairs</em>, <em>coords0=None</em><big>)</big><a class="reference internal" href="_modules/quickff/model.html#CoulPointPot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.CoulPointPot" title="Permalink to this definition">¶</a></dt>
<dd><p>A class defining the Coulomb potential between point charges to describe
the FF electrostatic energy.</p>
</dd></dl>

<dl class="class">
<dt id="quickff.model.CoulGaussPot">
<em class="property">class </em><tt class="descclassname">quickff.model.</tt><tt class="descname">CoulGaussPot</tt><big>(</big><em>charges</em>, <em>sigmas</em>, <em>scales</em>, <em>scaled_pairs</em>, <em>coords0=None</em><big>)</big><a class="reference internal" href="_modules/quickff/model.html#CoulGaussPot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.CoulGaussPot" title="Permalink to this definition">¶</a></dt>
<dd><p>A class defining the Coulomb potential between gaussian charges to describe
the FF electrostatic energy.</p>
</dd></dl>

<dl class="class">
<dt id="quickff.model.LennardJonesPot">
<em class="property">class </em><tt class="descclassname">quickff.model.</tt><tt class="descname">LennardJonesPot</tt><big>(</big><em>sigmas</em>, <em>epsilons</em>, <em>scales</em>, <em>scaled_pairs</em>, <em>coords0=None</em><big>)</big><a class="reference internal" href="_modules/quickff/model.html#LennardJonesPot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.LennardJonesPot" title="Permalink to this definition">¶</a></dt>
<dd><p>A class defining the Lennard-Jones potential between atom pairs to
describe the FF van der Waals energy.</p>
</dd></dl>

<dl class="class">
<dt id="quickff.model.MM3BuckinghamPot">
<em class="property">class </em><tt class="descclassname">quickff.model.</tt><tt class="descname">MM3BuckinghamPot</tt><big>(</big><em>sigmas</em>, <em>epsilons</em>, <em>scales</em>, <em>scaled_pairs</em>, <em>coords0=None</em><big>)</big><a class="reference internal" href="_modules/quickff/model.html#MM3BuckinghamPot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.MM3BuckinghamPot" title="Permalink to this definition">¶</a></dt>
<dd><p>A class defining the MM3-Buckingham potential between atom pairs to
describe the FF van der Waals energy.</p>
</dd></dl>

<dl class="class">
<dt id="quickff.model.TermListPot">
<em class="property">class </em><tt class="descclassname">quickff.model.</tt><tt class="descname">TermListPot</tt><big>(</big><em>terms</em><big>)</big><a class="reference internal" href="_modules/quickff/model.html#TermListPot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quickff.model.TermListPot" title="Permalink to this definition">¶</a></dt>
<dd><p>A class for a potential defined as the sum of multiple terms to describe
the FF valence energy.</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="rg_system.html"
                        title="previous chapter">1. Module <tt class="docutils literal"><span class="pre">quickff.system</span></tt> &#8211; Representation of molecular systems</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="rg_program.html"
                        title="next chapter">3. Module <tt class="docutils literal"><span class="pre">quickff.program</span></tt> &#8211; Management of the entire program</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/rg_model.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="rg_program.html" title="3. Module quickff.program – Management of the entire program"
             >next</a> |</li>
        <li class="right" >
          <a href="rg_system.html" title="1. Module quickff.system – Representation of molecular systems"
             >previous</a> |</li>
        <li><a href="index.html">QuickFF 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Louis Vanduyfhuys.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>