<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1. Running QuickFF using qff-est.py &mdash; QuickFF 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="QuickFF 1.0 documentation" href="index.html" />
    <link rel="next" title="2. Importing QuickFF as a library" href="ug_library.html" />
    <link rel="prev" title="3. Installing QuickFF" href="ig_installation.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ug_library.html" title="2. Importing QuickFF as a library"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ig_installation.html" title="3. Installing QuickFF"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">QuickFF 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="running-quickff-using-qff-est-py">
<h1>1. Running QuickFF using qff-est.py<a class="headerlink" href="#running-quickff-using-qff-est-py" title="Permalink to this headline">¶</a></h1>
<p>The most straightforward use of QuickFF is by means of a single command using
the <a class="reference internal" href="rg_qffest.html#seclab-rg-qffest"><em>qff-est.py</em></a> script. The basis usage of this script
is as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>qff-est.py [options] fns
</pre></div>
</div>
<p>In the sections below, both the input files and the optional arguments are
discussed in detail. The description below is further illustrated with examples
in the <a class="reference internal" href="index.html#seclab-tutorials"><em>tutorials</em></a>.</p>
<div class="section" id="input-files">
<span id="seclab-inputfiles"></span><h2>1.1. Input files<a class="headerlink" href="#input-files" title="Permalink to this headline">¶</a></h2>
<p>The script requires one or more input files describing the system, reference
data and non-bonding part of the force field. These files are parsed to the
program by means of the mandatory argument <cite>fns</cite> which is either a filename, or
a list of filenames seperated by spaces. The following list enumerates all
possible formats of input files, as well as a specification of which kind of
information will be extracted from that particular file:</p>
<ul>
<li><p class="first"><strong>Gaussian formatted checkpoint file</strong> (file.fchk):</p>
<blockquote>
<div><p>a file generated using the
<a class="reference external" href="http://www.gaussian.com/g_tech/g_ur/u_formchk.htm">formchk</a> utility on a
checkpoint file from a Gaussian
<a class="reference external" href="http://www.gaussian.com/g_tech/g_ur/k_freq.htm">freq</a> job. The atomic
numbers, equilibrium geometry and equilibrium Hessian are extracted from
this file.</p>
</div></blockquote>
</li>
<li><p class="first"><strong>HDF5 file</strong> (file.h5):</p>
<blockquote>
<div><p>a <a class="reference external" href="http://www.hdfgroup.org/HDF5/">Hierarchical Data Format</a> Release 5
(HDF5) file (for example generated by
<a class="reference external" href="http://theochem.github.com/horton/">Horton</a>) from which parameters for
the non-bonding force field can be extracted. If the option
&#8211;ei-path=${EI_PATH} from the <a class="reference internal" href="rg_qffest.html#seclab-rg-qffest"><em>qff-est.py</em></a> script
is specified, charges (and possibly atomic radii) will be taken from the
dataset <cite>${EI_PATH}/charges</cite> (and <cite>${EI_PATH}/radii</cite>). Analogously, if the
option &#8211;vdw-path=${VDW_PATH} is specified, epsilon and sigma parameters
for the van der Waals interactions will be extracted from the datasets
<cite>${VDW_PATH}/epsilons</cite> and <cite>${VDW_PATH}/sigmas</cite>.</p>
</div></blockquote>
</li>
<li><p class="first"><strong>PSF file</strong> (file.psf):</p>
<blockquote>
<div><p>a Protein Structure File (PSF) containing bond, bending and dihedral
patterns, atomic numbers, force field atom types and atomic charges. All
this information is extracted.</p>
</div></blockquote>
</li>
<li><p class="first"><strong>MolMod checkpoint file</strong> (file.chk, file.mfs):</p>
<blockquote>
<div><p>a checkpoint file with a simple format designed to be easily readable for
post processing using Python tools (see the
<a class="reference external" href="http://molmod.github.io/molmod/">MolMod</a> package for more information).
The extracted information includes atomic numbers, atomic charges,
force field atom types, bond, bend, dihedral and out-of-plane patterns,
equilibrium geometry and equilibrium Hessian.</p>
</div></blockquote>
</li>
</ul>
<p>Duplicate information gets overwritten by files later in the <cite>fns</cite> arguments.
If no bond patterns are given, they are estimated by means of common bond
lengths. If no bend, dihedral and/or out-of-plane patterns are given, they are
determined from the bond patterns. All this is done using the <cite>MolecularGraph</cite>
class from the MolMod pakcage. If no charges are given, they are automatically
set to zero.</p>
</div>
<div class="section" id="automatic-estimation-of-atom-types">
<span id="seclab-ug-atype-estimator"></span><h2>1.2. Automatic estimation of atom types<a class="headerlink" href="#automatic-estimation-of-atom-types" title="Permalink to this headline">¶</a></h2>
<p>The optional argument <em class="xref std std-option">--atypes-level</em> will trigger the automatic
assignation of atom types to every atom in the system. There are four possible
levels of assignation:</p>
<blockquote>
<div><ul class="simple">
<li><em>low</em>: atom type is based on atom number</li>
<li><em>medium</em>: atom type is based on atom number and number of neighbors.</li>
<li><em>high</em>: atom type is based on atom number, number of neighbors and the atom number of those neighbors.</li>
<li><em>highest</em>: every single atom is given a unique atom type based on its index in the system.</li>
</ul>
</div></blockquote>
<p>The levels <cite>medium</cite> and <cite>high</cite> are the most usefull, <cite>medium</cite> will result in
higher transferability of the force field parameters, while <cite>high</cite> will
result in higher accuracy. The levels <cite>low</cite> and <cite>highest</cite> are mostly usefull
for debugging purposes. The automatic assignation for the levels <cite>medium</cite>
and <cite>high</cite> is illustrated for three different molecules in the figures
below. If the level <cite>medium</cite> is chosen, atom type strings will be of the
form <em>EN</em> in which <em>E</em> is the element and <em>N</em> is the number of neighbors.
When choosing atom types according to the level <cite>high</cite>, atom type strings
will be of the form <em>ENs</em> in which <em>E</em> is the element, <em>N</em> is the number
of neighbors and <em>s</em> is a string describing the neighbors. If the atom has
only 1 neighbor, then <em>s</em> is equal <em>_e</em> with <em>e</em> the element of the
neighbor. If the atom under consideration has 2 neighbors, then <em>s</em> is equal
to <em>_ee</em> in which the first and second <em>e</em> represent the element of the
first and second neighbor respectively. If the atom has more than 2
neighbors, then <em>s</em> will contain a substring <em>_en</em> for every neighboring
atom that is either a carbon, a nitrogen or a oxygen atom. In this
substring, <em>e</em> represents the neighbor element (and is either c, n or o) and
<em>n</em> is the number of neighbors of that particular neighbor element.
Multiple instances of this <em>_en</em> string are ordered according to atomic
number.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/atypes_medium.png"><img alt="Medium-level atom types" src="_images/atypes_medium.png" style="width: 898.5px; height: 304.0px;" /></a>
<p class="caption"><strong>Figure</strong>: Medium-level atom types</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/atypes_high.png"><img alt="High-level atom types" src="_images/atypes_high.png" style="width: 943.0px; height: 310.0px;" /></a>
<p class="caption"><strong>Figure</strong>: High-level atom types</p>
</div>
<p>By default, the automatic assignation is switched off and the atom types are
suposed to be defined in the <a class="reference internal" href="#seclab-inputfiles"><em>input files</em></a>.</p>
</div>
<div class="section" id="internal-coordinates-in-the-valence-model">
<h2>1.3. Internal Coordinates in the valence model<a class="headerlink" href="#internal-coordinates-in-the-valence-model" title="Permalink to this headline">¶</a></h2>
<p>The use of the optional argument <em class="xref std std-option">--ic-ids</em> will allow one to define the
internal coordinates that will be included in model of the covalent
interactions. For every internal coordinate allowed by this option, a Harmonic
or Cosine term will be added to the covalent energy. The value of this options
should be a comma-separated list of identifiers specifying internal coordinates
names. Each identifier can be a specific IC name (e.g. bond/C3_cc.H1_c) or can
be one of the following strings: <em>bonds</em>, <em>angles</em>, <em>diheds</em> or <em>opdists</em>,
in which case all bonds, angles, ... will be included. Additionally, one can
also define this option value using the single string <em>all</em>, in which case all
internal coordinates in the system will be attributed a valence term. By
default, all internal coordinates will be included in the valence model.</p>
</div>
<div class="section" id="electrostatic-interactions">
<h2>1.4. Electrostatic interactions<a class="headerlink" href="#electrostatic-interactions" title="Permalink to this headline">¶</a></h2>
<ul>
<li><dl class="first docutils">
<dt>Model (<em class="xref std std-option">--ei-model</em>):</dt>
<dd><p class="first last">Defines the potential used for the electrostatic interactions. Can be
CoulPoint, CoulGauss, HarmPoint, HarmGauss or Zero. If CoulPoint/CoulGauss
is chosen, the exact Coulombic potential between point/gaussian charges
will be used to evaluate EI interactions. If HarmPoint/HarmGauss is chosen,
a second order Taylor expansion of the Coulomb potential is used. Harmonic
is a lot faster and should already give accurate results. By default,
the harmonic approximation to the point-charge interaction will be used
(HarmPoint).</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Scaling (<em class="xref std std-option">--ei-scales</em>):</dt>
<dd><p class="first last">Defines the scaling rule for the electrostatic interactions. Three
comma-separated floats are required. The first one sets the scale for atoms
separated by 1 bond, the second for atoms separated by 2 bonds and the third
for atoms separated by 3 bonds. This option can also be used to exclude,
for example, 1-2 bonded atoms by simply setting the first float to zero.
By default, 1-2 and 1-3 interactions are excluded and 1-4 interactions are
left unscaled, i.e. <em class="xref std std-option">--ei-scales=0.0,0.0,1.0</em></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Charges and atomic radii (<em class="xref std std-option">--ei-path</em>):</dt>
<dd><p class="first last">Defines the path in the HDF5 file, given as an input file, from which the
charges will be extracted. Charges (and atomic radii in case of Gaussian
charges) will be read from the dataset <cite>${EI_PATH}/charges</cite> (and
<cite>${EI_PATH}/radii</cite>) in the HDF5 file.</p>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="van-der-waals-interactions">
<h2>1.5. Van der Waals interactions<a class="headerlink" href="#van-der-waals-interactions" title="Permalink to this headline">¶</a></h2>
<ul>
<li><dl class="first docutils">
<dt>Model (<em class="xref std std-option">--vdw-model</em>):</dt>
<dd><p class="first last">Defines the potential used for van der Waals interactions. Can be LJ, MM3,
HarmLJ, HarmMM3 or Zero. If LJ/MM3 is chosen, the exact
Lennard-Jones/MM3-Buckingham potential will be used to evaluate van der
Waals interactions. If HarmLJ/HarmMM3 is chosen, a second order Taylor
expansion of the LJ/MM3 potential is used. Harmonic is a lot faster and
should already give accurate results. If Zero is chosen, no van der Waals
interactions will be taken into account during the force field
parameterisation. By default, Zero is chosen.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Scaling (<em class="xref std std-option">--vdw-scales</em>):</dt>
<dd><p class="first last">Defines the scaling rule for the van der Waals interactions. Three
comma-separated floats are required. The first one sets the scale for atoms
separated by 1 bond, the second for atoms separated by 2 bonds and the third
for atoms separated by 3 bonds. This option can also be used to exclude,
for example, 1-2 bonded atoms by simply setting the first float to zero.
By default, 1-2 and 1-3 interactions are excluded and 1-4 interactions are
left unscaled, i.e. <em class="xref std std-option">--vdw-scales=0.0,0.0,1.0</em></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Epsilons and sigmas (<em class="xref std std-option">--vdw-path</em>):</dt>
<dd><p class="first last">Defines the path in the HDF5 file, given as an input file, from which the
epsilon and sigma values will be extracted. Epsilons and sigmas will be
read from the dataset <cite>${VDW_PATH}/charges</cite> (<cite>${VDW_PATH}/radii</cite>) in the
HDF5 file.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Other force field (<em class="xref std std-option">--vdw-from</em>):</dt>
<dd><p class="first last">Defines from which force field to extract vdW parameters. If this value is
anythin else then None, the values extracted from a HDF5 file will be
overwritten. Currently only UFF is supported.</p>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="parallel-quickff">
<h2>1.6. Parallel QuickFF<a class="headerlink" href="#parallel-quickff" title="Permalink to this headline">¶</a></h2>
<p>If Scoop is installed, it is possible to run QuickFF on multiple cores of a
single node by using the optional argument <em class="xref std std-option">--scoop</em>. Only the
generation of the perturbation trajectories will be parallized as it is by far
the time determening step. The exact syntax to use QuickFF in parallel is:</p>
<div class="highlight-python"><div class="highlight"><pre>python -m scoop -n nproc /path/to/qff-est.py --scoop [options] fns
</pre></div>
</div>
<p><em>nproc</em> is the number of processes that can be launched simultaneously. It is
important to note that one has to define the absolute path to the location of
the <cite>qff-est.py</cite> script. Finally, <cite>[options]</cite> and <cite>fns</cite> have the same meaning as
in the serial version.</p>
</div>
<div class="section" id="miscellanous-options">
<h2>1.7. Miscellanous options<a class="headerlink" href="#miscellanous-options" title="Permalink to this headline">¶</a></h2>
<ul>
<li><dl class="first docutils">
<dt>Output file suffix (<em class="xref std std-option">--suffix</em>):</dt>
<dd><p class="first last">Suffix that will be added to all output files. By default, no suffix is
added.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Trajectory storing/loading (<em class="xref std std-option">--fn-traj</em>):</dt>
<dd><p class="first last">Depending if the given option argument corresponds to an existing file or
not, this option will load/save perturbation trajectories to/from a cPickled
file.</p>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="output">
<h2>1.8. Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<p>During the derivation of the force field, QuickFF will dump some usefull
information to the screen including machine information, system information,
model information, the force field parameters after the perturbation step and
the final force field parameters. Additionally, three output files are
generated:</p>
<ul>
<li><p class="first">system.chk:</p>
<blockquote>
<div><p>A MolMod checkpoint file containing all system information. This file can be
used to start new QuickFF calculations or to perform force field simulations
using <a class="reference external" href="http://molmod.github.io/yaff/">Yaff</a> together with the file
pars_yaff.txt.</p>
</div></blockquote>
</li>
<li><p class="first">pars_yaff.txt:</p>
<blockquote>
<div><p>A formatted text file defining the final force field. This file can be read
by <a class="reference external" href="http://molmod.github.io/yaff/">Yaff</a> together with the file
system.chk, to perform force field simulations.</p>
</div></blockquote>
</li>
<li><p class="first">pars_ffit2.txt</p>
<blockquote>
<div><p>A formatted text file defining the final force field. This file can be read
by FFit2 to further fine tune the force field if desired.</p>
</div></blockquote>
</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1. Running QuickFF using qff-est.py</a><ul>
<li><a class="reference internal" href="#input-files">1.1. Input files</a></li>
<li><a class="reference internal" href="#automatic-estimation-of-atom-types">1.2. Automatic estimation of atom types</a></li>
<li><a class="reference internal" href="#internal-coordinates-in-the-valence-model">1.3. Internal Coordinates in the valence model</a></li>
<li><a class="reference internal" href="#electrostatic-interactions">1.4. Electrostatic interactions</a></li>
<li><a class="reference internal" href="#van-der-waals-interactions">1.5. Van der Waals interactions</a></li>
<li><a class="reference internal" href="#parallel-quickff">1.6. Parallel QuickFF</a></li>
<li><a class="reference internal" href="#miscellanous-options">1.7. Miscellanous options</a></li>
<li><a class="reference internal" href="#output">1.8. Output</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ig_installation.html"
                        title="previous chapter">3. Installing QuickFF</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ug_library.html"
                        title="next chapter">2. Importing QuickFF as a library</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/ug_script.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ug_library.html" title="2. Importing QuickFF as a library"
             >next</a> |</li>
        <li class="right" >
          <a href="ig_installation.html" title="3. Installing QuickFF"
             >previous</a> |</li>
        <li><a href="index.html">QuickFF 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Louis Vanduyfhuys.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>